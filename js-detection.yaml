id: javascript-detection

info:
  name: Detect Sensitive Data in JavaScript Files
  author: Just An NPC A.K.A N30NYM0US A.K.A Hann
  severity: high
  description: This template is designed to detect sensitive data like access keys, tokens, and passwords in JavaScript files.
  tags: sensitive, javascript, security, exposure, exposures

requests:
  - method: GET
    path:
      - "{{BaseURL}}/*.js"

    matchers-condition: and

    matchers:
      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        name: "Access Key"
        regex:
          - "access_key[^\\s]*"

      - type: regex
        part: body
        name: "Access Token"
        regex:
          - "access_token[^\\s]*"

      - type: regex
        part: body
        name: "Admin Password"
        regex:
          - "admin_pass[^\\s]*"

      - type: regex
        part: body
        name: "Admin User"
        regex:
          - "admin_user[^\\s]*"

      - type: regex
        part: body
        name: "Algolia Admin Key"
        regex:
          - "algolia_admin_key[^\\s]*"

      - type: regex
        part: body
        name: "Algolia API Key"
        regex:
          - "algolia_api_key[^\\s]*"

      - type: regex
        part: body
        name: "Alias Password"
        regex:
          - "alias_pass[^\\s]*"

      - type: regex
        part: body
        name: "Alicloud Access Key"
        regex:
          - "alicloud_access_key[^\\s]*"

      - type: regex
        part: body
        name: "Amazon Secret Access Key"
        regex:
          - "amazon_secret_access_key[^\\s]*"

      - type: regex
        part: body
        name: "Amazon AWS"
        regex:
          - "amazonaws[^\\s]*"

      - type: regex
        part: body
        name: "Ansible Vault Password"
        regex:
          - "ansible_vault_password[^\\s]*"

      - type: regex
        part: body
        name: "AOS Key"
        regex:
          - "aos_key[^\\s]*"

      - type: regex
        part: body
        name: "API Key"
        regex:
          - "api_key[^\\s]*"
          - "api\\.googlemaps\\s*AIza[0-9A-Za-z\\-_]{35}"

      - type: regex
        part: body
        name: "API Key Secret"
        regex:
          - "api_key_secret[^\\s]*"

      - type: regex
        part: body
        name: "API Key SID"
        regex:
          - "api_key_sid[^\\s]*"

      - type: regex
        part: body
        name: "API Secret"
        regex:
          - "api_secret[^\\s]*"

      - type: regex
        part: body
        name: "APIDocs"
        regex:
          - "apidocs[^\\s]*"

      - type: regex
        part: body
        name: "API Secret"
        regex:
          - "apiSecret[^\\s]*"

      - type: regex
        part: body
        name: "App Debug"
        regex:
          - "app_debug[^\\s]*"

      - type: regex
        part: body
        name: "App ID"
        regex:
          - "app_id[^\\s]*"

      - type: regex
        part: body
        name: "App Key"
        regex:
          - "app_key[^\\s]*"

      - type: regex
        part: body
        name: "App Log Level"
        regex:
          - "app_log_level[^\\s]*"

      - type: regex
        part: body
        name: "App Secret"
        regex:
          - "app_secret[^\\s]*"

      - type: regex
        part: body
        name: "App Key"
        regex:
          - "appkey[^\\s]*"

      - type: regex
        part: body
        name: "App Key Secret"
        regex:
          - "appkeysecret[^\\s]*"

      - type: regex
        part: body
        name: "Application Key"
        regex:
          - "application_key[^\\s]*"

      - type: regex
        part: body
        name: "App Secret"
        regex:
          - "appsecret[^\\s]*"

      - type: regex
        part: body
        name: "Appspot"
        regex:
          - "appspot[^\\s]*"

      - type: regex
        part: body
        name: "Auth Token"
        regex:
          - "auth_token[^\\s]*"

      - type: regex
        part: body
        name: "Authorization Token"
        regex:
          - "authorizationToken[^\\s]*"

      - type: regex
        part: body
        name: "Auth Secret"
        regex:
          - "authsecret[^\\s]*"

      - type: regex
        part: body
        name: "AWS Access"
        regex:
          - "aws_access[^\\s]*"

      - type: regex
        part: body
        name: "AWS Access Key ID"
        regex:
          - "aws_access_key_id[^\\s]*"

      - type: regex
        part: body
        name: "AWS Bucket"
        regex:
          - "aws_bucket[^\\s]*"

      - type: regex
        part: body
        name: "AWS Key"
        regex:
          - "aws_key[^\\s]*"

      - type: regex
        part: body
        name: "AWS Secret Key"
        regex:
          - "aws_secret_key[^\\s]*"

      - type: regex
        part: body
        name: "AWS Token"
        regex:
          - "aws_token[^\\s]*"

      - type: regex
        part: body
        name: "AWS Secret Key"
        regex:
          - "AWSSecretKey[^\\s]*"

      - type: regex
        part: body
        name: "B2 App Key"
        regex:
          - "b2_app_key[^\\s]*"

      - type: regex
        part: body
        name: "Bashrc Password"
        regex:
          - "bashrc\\s*password[^\\s]*"

      - type: regex
        part: body
        name: "Bintray API Key"
        regex:
          - "bintray_apikey[^\\s]*"

      - type: regex
        part: body
        name: "Bintray GPG Password"
        regex:
          - "bintray_gpg_password[^\\s]*"

      - type: regex
        part: body
        name: "Bintray Key"
        regex:
          - "bintray_key[^\\s]*"

      - type: regex
        part: body
        name: "Bintray Key (Alt)"
        regex:
          - "bintraykey[^\\s]*"

      - type: regex
        part: body
        name: "Bluemix API Key"
        regex:
          - "bluemix_api_key[^\\s]*"

      - type: regex
        part: body
        name: "Bluemix Password"
        regex:
          - "bluemix_pass[^\\s]*"

      - type: regex
        part: body
        name: "BrowserStack Access Key"
        regex:
          - "browserstack_access_key[^\\s]*"

      - type: regex
        part: body
        name: "Bucket Password"
        regex:
          - "bucket_password[^\\s]*"

      - type: regex
        part: body
        name: "Bucketeer AWS Access Key ID"
        regex:
          - "bucketeer_aws_access_key_id[^\\s]*"

      - type: regex
        part: body
        name: "Bucketeer AWS Secret Access Key"
        regex:
          - "bucketeer_aws_secret_access_key[^\\s]*"

      - type: regex
        part: body
        name: "Built Branch Deploy Key"
        regex:
          - "built_branch_deploy_key[^\\s]*"

      - type: regex
        part: body
        name: "BX Password"
        regex:
          - "bx_password[^\\s]*"

      - type: regex
        part: body
        name: "Cache Driver"
        regex:
          - "cache_driver[^\\s]*"

      - type: regex
        part: body
        name: "Cache S3 Secret Key"
        regex:
          - "cache_s3_secret_key[^\\s]*"

      - type: regex
        part: body
        name: "Cattle Access Key"
        regex:
          - "cattle_access_key[^\\s]*"

      - type: regex
        part: body
        name: "Cattle Secret Key"
        regex:
          - "cattle_secret_key[^\\s]*"

      - type: regex
        part: body
        name: "Certificate Password"
        regex:
          - "certificate_password[^\\s]*"

      - type: regex
        part: body
        name: "CI Deploy Password"
        regex:
          - "ci_deploy_password[^\\s]*"

      - type: regex
        part: body
        name: "Client Secret"
        regex:
          - "client_secret[^\\s]*"

      - type: regex
        part: body
        name: "Client ZPK Secret Key"
        regex:
          - "client_zpk_secret_key[^\\s]*"

      - type: regex
        part: body
        name: "Clojars Password"
        regex:
          - "clojars_password[^\\s]*"

      - type: regex
        part: body
        name: "Cloud API Key"
        regex:
          - "cloud_api_key[^\\s]*"

      - type: regex
        part: body
        name: "Cloud Watch AWS Access Key"
        regex:
          - "cloud_watch_aws_access_key[^\\s]*"

      - type: regex
        part: body
        name: "Cloudant Password"
        regex:
          - "cloudant_password[^\\s]*"

      - type: regex
        part: body
        name: "Cloudflare API Key"
        regex:
          - "cloudflare_api_key[^\\s]*"

      - type: regex
        part: body
        name: "Cloudflare Auth Key"
        regex:
          - "cloudflare_auth_key[^\\s]*"

      - type: regex
        part: body
        name: "Cloudinary API Secret"
        regex:
          - "cloudinary_api_secret[^\\s]*"

      - type: regex
        part: body
        name: "Cloudinary Name"
        regex:
          - "cloudinary_name[^\\s]*"

      - type: regex
        part: body
        name: "Codecov Token"
        regex:
          - "codecov_token[^\\s]*"

      - type: regex
        part: body
        name: "Config"
        regex:
          - "config[^\\s]*"

      - type: regex
        part: body
        name: "Connection Login"
        regex:
          - "conn\\.login[^\\s]*"

      - type: regex
        part: body
        name: "Connection String"
        regex:
          - "connectionstring[^\\s]*"

      - type: regex
        part: body
        name: "Consumer Key"
        regex:
          - "consumer_key[^\\s]*"

      - type: regex
        part: body
        name: "Consumer Secret"
        regex:
          - "consumer_secret[^\\s]*"

      - type: regex
        part: body
        name: "Credentials"
        regex:
          - "credentials[^\\s]*"

      - type: regex
        part: body
        name: "Cypress Record Key"
        regex:
          - "cypress_record_key[^\\s]*"

      - type: regex
        part: body
        name: "Database Password"
        regex:
          - "database_password[^\\s]*"

      - type: regex
        part: body
        name: "Database Schema Test"
        regex:
          - "database_schema_test[^\\s]*"

      - type: regex
        part: body
        name: "Datadog API Key"
        regex:
          - "datadog_api_key[^\\s]*"

      - type: regex
        part: body
        name: "Datadog App Key"
        regex:
          - "datadog_app_key[^\\s]*"

      - type: regex
        part: body
        name: "DB Password"
        regex:
          - "db_password[^\\s]*"

      - type: regex
        part: body
        name: "DB Server"
        regex:
          - "db_server[^\\s]*"

      - type: regex
        part: body
        name: "DB Username"
        regex:
          - "db_username[^\\s]*"

      - type: regex
        part: body
        name: "DB Password (Alt)"
        regex:
          - "dbpasswd[^\\s]*"
          - "dbpassword[^\\s]*"

      - type: regex
        part: body
        name: "DB User"
        regex:
          - "dbuser[^\\s]*"

      - type: regex
        part: body
        name: "Deploy Password"
        regex:
          - "deploy_password[^\\s]*"

      - type: regex
        part: body
        name: "DigitalOcean SSH Key Body"
        regex:
          - "digitalocean_ssh_key_body[^\\s]*"

      - type: regex
        part: body
        name: "DigitalOcean SSH Key IDs"
        regex:
          - "digitalocean_ssh_key_ids[^\\s]*"

      - type: regex
        part: body
        name: "Docker Hub Password"
        regex:
          - "docker_hub_password[^\\s]*"

      - type: regex
        part: body
        name: "Docker Key"
        regex:
          - "docker_key[^\\s]*"

      - type: regex
        part: body
        name: "Docker Password"
        regex:
          - "docker_pass[^\\s]*"
          - "docker_passwd[^\\s]*"
          - "docker_password[^\\s]*"

      - type: regex
        part: body
        name: "Dockerhub Password"
        regex:
          - "dockerhub_password[^\\s]*"
          - "dockerhubpassword[^\\s]*"

      - type: regex
        part: body
        name: "Dot Files"
        regex:
          - "dot-files[^\\s]*"
          - "dotfiles[^\\s]*"

      - type: regex
        part: body
        name: "Droplet Travis Password"
        regex:
          - "droplet_travis_password[^\\s]*"

      - type: regex
        part: body
        name: "DynamoDB Access Key ID"
        regex:
          - "dynamoaccesskeyid[^\\s]*"

      - type: regex
        part: body
        name: "DynamoDB Secret Access Key"
        regex:
          - "dynamosecretaccesskey[^\\s]*"

      - type: regex
        part: body
        name: "Elastica Host"
        regex:
          - "elastica_host[^\\s]*"

      - type: regex
        part: body
        name: "Elastica Port"
        regex:
          - "elastica_port[^\\s]*"

      - type: regex
        part: body
        name: "Elasticsearch Password"
        regex:
          - "elasticsearch_password[^\\s]*"

      - type: regex
        part: body
        name: "Encryption Key"
        regex:
          - "encryption_key[^\\s]*"

      - type: regex
        part: body
        name: "Encryption Password"
        regex:
          - "encryption_password[^\\s]*"

      - type: regex
        part: body
        name: "Heroku API Key"
        regex:
          - "heroku_api_key[^\\s]*"

      - type: regex
        part: body
        name: "Sonatype Password"
        regex:
          - "sonatype_password[^\\s]*"

      - type: regex
        part: body
        name: "AWS Secret Key (Alt)"
        regex:
          - "awssecretkey[^\\s]*"
         

reporting:
  script: |
    var path = response.final_url.replace(/.*\//, '');
    var extractors = {
      "Access Key": "{{extractors.Access Key}}",
      "Access Token": "{{extractors.Access Token}}",
      "Admin Password": "{{extractors.Admin Password}}",
      "Admin User": "{{extractors.Admin User}}",
      "Algolia Admin Key": "{{extractors.Algolia Admin Key}}",
      "Algolia API Key": "{{extractors.Algolia API Key}}",
      "Alias Password": "{{extractors.Alias Password}}",
      "Alicloud Access Key": "{{extractors.Alicloud Access Key}}",
      "Amazon Secret Access Key": "{{extractors.Amazon Secret Access Key}}",
      "Amazon AWS": "{{extractors.Amazon AWS}}",
      "Ansible Vault Password": "{{extractors.Ansible Vault Password}}",
      "AOS Key": "{{extractors.AOS Key}}",
      "API Key": "{{extractors.API Key}}",
      "API Key Secret": "{{extractors.API Key Secret}}",
      "API Key SID": "{{extractors.API Key SID}}",
      "API Secret": "{{extractors.API Secret}}",
      "APIDocs": "{{extractors.APIDocs}}",
      "API Secret": "{{extractors.API Secret}}",
      "App Debug": "{{extractors.App Debug}}",
      "App ID": "{{extractors.App ID}}",
      "App Key": "{{extractors.App Key}}",
      "App Log Level": "{{extractors.App Log Level}}",
      "App Secret": "{{extractors.App Secret}}",
      "App Key": "{{extractors.App Key}}",
      "App Key Secret": "{{extractors.App Key Secret}}",
      "Application Key": "{{extractors.Application Key}}",
      "App Secret": "{{extractors.App Secret}}",
      "Appspot": "{{extractors.Appspot}}",
      "Auth Token": "{{extractors.Auth Token}}",
      "Authorization Token": "{{extractors.Authorization Token}}",
      "Auth Secret": "{{extractors.Auth Secret}}",
      "AWS Access": "{{extractors.AWS Access}}",
      "AWS Access Key ID": "{{extractors.AWS Access Key ID}}",
      "AWS Bucket": "{{extractors.AWS Bucket}}",
      "AWS Key": "{{extractors.AWS Key}}",
      "AWS Secret Key": "{{extractors.AWS Secret Key}}",
      "AWS Token": "{{extractors.AWS Token}}",
      "AWS Secret Key": "{{extractors.AWS Secret Key}}",
      "B2 App Key": "{{extractors.B2 App Key}}",
      "Bashrc Password": "{{extractors.Bashrc Password}}",
      "Bintray API Key": "{{extractors.Bintray API Key}}",
      "Bintray GPG Password": "{{extractors.Bintray GPG Password}}",
      "Bintray Key": "{{extractors.Bintray Key}}",
      "Bintray Key (Alt)": "{{extractors.Bintray Key (Alt)}}",
      "Bluemix API Key": "{{extractors.Bluemix API Key}}",
      "Bluemix Password": "{{extractors.Bluemix Password}}",
      "BrowserStack Access Key": "{{extractors.BrowserStack Access Key}}",
      "Bucket Password": "{{extractors.Bucket Password}}",
      "Bucketeer AWS Access Key ID": "{{extractors.Bucketeer AWS Access Key ID}}",
      "Bucketeer AWS Secret Access Key": "{{extractors.Bucketeer AWS Secret Access Key}}",
      "Built Branch Deploy Key": "{{extractors.Built Branch Deploy Key}}",
      "BX Password": "{{extractors.BX Password}}",
      "Cache Driver": "{{extractors.Cache Driver}}",
      "Cache S3 Secret Key": "{{extractors.Cache S3 Secret Key}}",
      "Cattle Access Key": "{{extractors.Cattle Access Key}}",
      "Cattle Secret Key": "{{extractors.Cattle Secret Key}}",
      "Certificate Password": "{{extractors.Certificate Password}}",
      "CI Deploy Password": "{{extractors.CI Deploy Password}}",
      "Client Secret": "{{extractors.Client Secret}}",
      "Client ZPK Secret Key": "{{extractors.Client ZPK Secret Key}}",
      "Clojars Password": "{{extractors.Clojars Password}}",
      "Cloud API Key": "{{extractors.Cloud API Key}}",
      "Cloud Watch AWS Access Key": "{{extractors.Cloud Watch AWS Access Key}}",
      "Cloudant Password": "{{extractors.Cloudant Password}}",
      "Cloudflare API Key": "{{extractors.Cloudflare API Key}}",
      "Cloudflare Auth Key": "{{extractors.Cloudflare Auth Key}}",
      "Cloudinary API Secret": "{{extractors.Cloudinary API Secret}}",
      "Cloudinary Name": "{{extractors.Cloudinary Name}}",
      "Codecov Token": "{{extractors.Codecov Token}}",
      "Config": "{{extractors.Config}}",
      "Connection Login": "{{extractors.Connection Login}}",
      "Connection String": "{{extractors.Connection String}}",
      "Consumer Key": "{{extractors.Consumer Key}}",
      "Consumer Secret": "{{extractors.Consumer Secret}}",
      "Credentials": "{{extractors.Credentials}}",
      "Cypress Record Key": "{{extractors.Cypress Record Key}}",
      "Database Password": "{{extractors.Database Password}}",
      "Database Schema Test": "{{extractors.Database Schema Test}}",
      "Datadog API Key": "{{extractors.Datadog API Key}}",
      "Datadog App Key": "{{extractors.Datadog App Key}}",
      "DB Password": "{{extractors.DB Password}}",
      "DB Server": "{{extractors.DB Server}}",
      "DB Username": "{{extractors.DB Username}}",
      "DB Password (Alt)": "{{extractors.DB Password (Alt)}}",
      "DB User": "{{extractors.DB User}}",
      "Deploy Password": "{{extractors.Deploy Password}}",
      "DigitalOcean SSH Key Body": "{{extractors.DigitalOcean SSH Key Body}}",
      "DigitalOcean SSH Key IDs": "{{extractors.DigitalOcean SSH Key IDs}}",
      "Docker Hub Password": "{{extractors.Docker Hub Password}}",
      "Docker Key": "{{extractors.Docker Key}}",
      "Docker Password": "{{extractors.Docker Password}}",
      "Dockerhub Password": "{{extractors.Dockerhub Password}}",
      "Dot Files": "{{extractors.Dot Files}}",
      "Droplet Travis Password": "{{extractors.Droplet Travis Password}}",
      "DynamoDB Access Key ID": "{{extractors.DynamoDB Access Key ID}}",
      "DynamoDB Secret Access Key": "{{extractors.DynamoDB Secret Access Key}}",
      "Elastica Host": "{{extractors.Elastica Host}}",
      "Elastica Port": "{{extractors.Elastica Port}}",
      "Elasticsearch Password": "{{extractors.Elasticsearch Password}}",
      "Encryption Key": "{{extractors.Encryption Key}}",
      "Encryption Password": "{{extractors.Encryption Password}}",
      "Heroku API Key": "{{extractors.Heroku API Key}}",
      "Sonatype Password": "{{extractors.Sonatype Password}}",
      "AWS Secret Key (Alt)": "{{extractors.AWS Secret Key (Alt)}}"
    };

    var output = [];
    for (var key in extractors) {
      if (extractors[key]) {
        output.push(key + ": " + extractors[key]);
      }
    }

    if (output.length > 0) {
      report(path + " " + output.join(", "));
    }
